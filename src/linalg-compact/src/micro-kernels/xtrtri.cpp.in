#ifdef __clang__
#pragma clang fp contract(fast)
#endif

#include <koqkatoo/linalg-compact/compact/micro-kernels/xtrtri.tpp>

namespace koqkatoo::linalg::compact::micro_kernels::trtri {

using Abi = stdx::simd_abi::@simd_abi@;

// For tests
template void xtrtri_trmm_microkernel<Abi, 4>(mut_single_batch_matrix_accessor<Abi> A, index_t rows) noexcept;
template void xtrmm_microkernel<Abi, 4, 4>(single_batch_matrix_accessor<Abi> A, mut_single_batch_matrix_accessor<Abi> B, index_t rows) noexcept;
template void xtrtri_trmm_copy_T_microkernel<Abi, 4>(single_batch_matrix_accessor<Abi> Ain, mut_single_batch_matrix_accessor<Abi> Aout, index_t rows) noexcept;

template const constinit decltype(microkernel_lut<Abi>) microkernel_lut<Abi>;
template const constinit decltype(microkernel_copy_lut<Abi>) microkernel_copy_lut<Abi>;
template const constinit decltype(microkernel_trmm_lut<Abi>) microkernel_trmm_lut<Abi>;
template const constinit decltype(microkernel_T_copy_lut<Abi>) microkernel_T_copy_lut<Abi>;
template const constinit decltype(microkernel_trmm_T_copy_lut<Abi>) microkernel_trmm_T_copy_lut<Abi>;

}
