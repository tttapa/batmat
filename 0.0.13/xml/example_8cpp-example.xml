<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.16.1" xml:lang="en-US">
  <compounddef id="example_8cpp-example" kind="example">
    <compoundname>example.cpp</compoundname>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
<para><simplesect kind="par"><title>Basic example demonstrating how to use batmat to perform Cholesky factorization of a batch of matrices.</title><para><programlisting filename="example.cpp"><codeline><highlight class="preprocessor">#include<sp/>&lt;<ref refid="copy_8hpp" kindref="compound">batmat/linalg/copy.hpp</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="gemm_8hpp" kindref="compound">batmat/linalg/gemm.hpp</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="potrf_8hpp" kindref="compound">batmat/linalg/potrf.hpp</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="matrix_8hpp" kindref="compound">batmat/matrix/matrix.hpp</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;<ref refid="print_8hpp.html" kindref="compound" external="/home/runner/work/batmat/batmat/build/docs/guanaqo.tag">guanaqo/print.hpp</ref>&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;algorithm&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;cmath&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;iostream&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;limits&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;random&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">batmat::index_t;</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">batmat::real_t;</highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal"><ref refid="namespacebatmat_1_1linalg" kindref="compound">la</ref><sp/>=<sp/><ref refid="namespacebatmat_1_1linalg" kindref="compound">batmat::linalg</ref>;</highlight></codeline>
<codeline><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/><ref refid="example_8cpp_1ae66f6b31b5ad750f1fe042a706a4e3d4" kindref="member">main</ref>()<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">batch_size<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>=<sp/>std::integral_constant&lt;index_t,<sp/>4&gt;;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>storage_order<sp/>=<sp/>batmat::matrix::StorageOrder::ColMajor;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Class<sp/>representing<sp/>a<sp/>batch<sp/>of<sp/>four<sp/>matrices.</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">using<sp/></highlight><highlight class="normal">Mat<sp/>=<sp/><ref refid="structbatmat_1_1matrix_1_1Matrix" kindref="compound">batmat::matrix::Matrix&lt;real_t, index_t, batch_size, batch_size, storage_order&gt;</ref>;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Allocate<sp/>some<sp/>batches<sp/>of<sp/>matrices<sp/>(initialized<sp/>to<sp/>zero).</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__linalg__views_1gabed7475ccfc9ffbfefa79146942dd1ab" kindref="member" external="/home/runner/work/batmat/batmat/build/docs/guanaqo.tag">index_t</ref><sp/>n<sp/>=<sp/>3,<sp/>m<sp/>=<sp/>n<sp/>+<sp/>5;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Mat<sp/>C{{.rows<sp/>=<sp/>n,<sp/>.cols<sp/>=<sp/>n}},<sp/>A{{.rows<sp/>=<sp/>n,<sp/>.cols<sp/>=<sp/>m}};</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Fill<sp/>A<sp/>with<sp/>random<sp/>values.</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>std::mt19937<sp/>rng{12345};</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>std::uniform_real_distribution&lt;real_t&gt;<sp/>uni{-1.0,<sp/>1.0};</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>std::ranges::generate(A,<sp/>[&amp;]<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>uni(rng);<sp/>});</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Compute<sp/>C<sp/>=<sp/>AAᵀ<sp/>to<sp/>make<sp/>it<sp/>symmetric<sp/>positive<sp/>definite<sp/>(lower<sp/>triangular<sp/>part<sp/>only).</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__topic-linalg_1ga59ec2e76f7d857d495fcc518d19f2a77" kindref="member">la::syrk</ref>(A,<sp/><ref refid="group__topic-linalg_1gafc9f5555ed4639e0e5ad0e552f9717e4" kindref="member">la::tril</ref>(C));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Allocate<sp/>L<sp/>for<sp/>the<sp/>Cholesky<sp/>factors.</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>Mat<sp/>L{{.rows<sp/>=<sp/>n,<sp/>.cols<sp/>=<sp/>n},<sp/><ref refid="group__topic-matrix-utils_1gae1611b15c38c77550ccbe46aff4bdcea" kindref="member">batmat::matrix::uninitialized</ref>};</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Compute<sp/>the<sp/>Cholesky<sp/>factors<sp/>L<sp/>of<sp/>C<sp/>(lower<sp/>triangular).</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__topic-linalg_1gaf53b173cc76dd28168d422b8812298a3" kindref="member">la::fill</ref>(0,<sp/><ref refid="group__topic-linalg_1gaf6d9519ee15d51a0ba7243e640d8be71" kindref="member">la::triu</ref>(L));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__topic-linalg_1gaa5a48352d831fa72f651dfb4a53bba9e" kindref="member">la::potrf</ref>(<ref refid="group__topic-linalg_1gafc9f5555ed4639e0e5ad0e552f9717e4" kindref="member">la::tril</ref>(C),<sp/><ref refid="group__topic-linalg_1gafc9f5555ed4639e0e5ad0e552f9717e4" kindref="member">la::tril</ref>(L));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Print<sp/>the<sp/>results.</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(index_t<sp/>l<sp/>=<sp/>0;<sp/>l<sp/>&lt;<sp/>C.depth();<sp/>++l)<sp/>{</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__io_1ga756d1c6bfac4b93da66e64e5f9c2b463" kindref="member" external="/home/runner/work/batmat/batmat/build/docs/guanaqo.tag">guanaqo::print_python</ref>(std::cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;C[&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>l<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;]<sp/>=\n&quot;</highlight><highlight class="normal">,<sp/>C(l));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="group__io_1ga756d1c6bfac4b93da66e64e5f9c2b463" kindref="member" external="/home/runner/work/batmat/batmat/build/docs/guanaqo.tag">guanaqo::print_python</ref>(std::cout<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;L[&quot;</highlight><highlight class="normal"><sp/>&lt;&lt;<sp/>l<sp/>&lt;&lt;<sp/></highlight><highlight class="stringliteral">&quot;]<sp/>=\n&quot;</highlight><highlight class="normal">,<sp/>L(l));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Compute<sp/>LLᵀ<sp/>(in-place).</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="group__topic-linalg_1ga59ec2e76f7d857d495fcc518d19f2a77" kindref="member">la::syrk</ref>(<ref refid="group__topic-linalg_1gafc9f5555ed4639e0e5ad0e552f9717e4" kindref="member">la::tril</ref>(L));</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Check<sp/>that<sp/>LLᵀ<sp/>==<sp/>C.</highlight><highlight class="normal"></highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>errors<sp/><sp/><sp/><sp/><sp/>=<sp/>0;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>eps<sp/>=<sp/>std::numeric_limits&lt;real_t&gt;::epsilon();</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(index_t<sp/>l<sp/>=<sp/>0;<sp/>l<sp/>&lt;<sp/>C.depth();<sp/>++l)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(index_t<sp/>c<sp/>=<sp/>0;<sp/>c<sp/>&lt;<sp/>C.cols();<sp/>++c)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(index_t<sp/>r<sp/>=<sp/>c;<sp/>r<sp/>&lt;<sp/>C.rows();<sp/>++r)</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>errors<sp/>+=<sp/>std::abs(C(l,<sp/>r,<sp/>c)<sp/>-<sp/>L(l,<sp/>r,<sp/>c))<sp/>&lt;<sp/>10<sp/>*<sp/>eps<sp/>?<sp/>0<sp/>:<sp/>1;</highlight></codeline>
<codeline><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>errors;</highlight></codeline>
<codeline><highlight class="normal">}</highlight></codeline>
</programlisting> </para>
</simplesect>
</para>
    </detaileddescription>
    <location file="/home/runner/work/batmat/batmat/docs/source/doxygen/examples.md"/>
  </compounddef>
</doxygen>
